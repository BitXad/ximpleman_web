<?php
/* 
 * Generated by CRUDigniter v3.2 
 * www.crudigniter.com
 */
 
class Dosificacion extends CI_Controller{
    function __construct()
    {
        parent::__construct();
        $this->load->model('Dosificacion_model');
    } 

    /*
     * Listing of dosificacion
     */
    function index()
    {
        $params['limit'] = RECORDS_PER_PAGE; 
        $params['offset'] = ($this->input->get('per_page')) ? $this->input->get('per_page') : 0;
        
        $config = $this->config->item('pagination');
        $config['base_url'] = site_url('dosificacion/index?');
        $config['total_rows'] = $this->Dosificacion_model->get_all_dosificacion_count();
        $this->pagination->initialize($config);

        $data['dosificacion'] = $this->Dosificacion_model->get_all_dosificacion($params);
        
        $data['_view'] = 'dosificacion/index';
        $this->load->view('layouts/main',$data);
    }

    /*
     * Adding a new dosificacion
     */
    function add()
    {   
        if(isset($_POST) && count($_POST) > 0)     
        {   
            $params = array(
				'estado_id' => $this->input->post('estado_id'),
				'empresa_id' => $this->input->post('empresa_id'),
				'dosificacion_fechahora' => $this->input->post('dosificacion_fechahora'),
				'dosificacion_nitemisor' => $this->input->post('dosificacion_nitemisor'),
				'dosificacion_autorizacion' => $this->input->post('dosificacion_autorizacion'),
				'dosificacion_llave' => $this->input->post('dosificacion_llave'),
				'dosificacion_numfact' => $this->input->post('dosificacion_numfact'),
				'dosificacion_leyenda1' => $this->input->post('dosificacion_leyenda1'),
				'dosificacion_leyenda2' => $this->input->post('dosificacion_leyenda2'),
				'dosificacion_sucursal' => $this->input->post('dosificacion_sucursal'),
				'dosificacion_sfc' => $this->input->post('dosificacion_sfc'),
				'dosificacion_actividad' => $this->input->post('dosificacion_actividad'),
            );
            
            $dosificacion_id = $this->Dosificacion_model->add_dosificacion($params);
            redirect('dosificacion/index');
        }
        else
        {
			$this->load->model('Estado_model');
			$data['all_estado'] = $this->Estado_model->get_all_estado();

			$this->load->model('Empresa_model');
			$data['all_empresa'] = $this->Empresa_model->get_all_empresa();
            
            $data['_view'] = 'dosificacion/add';
            $this->load->view('layouts/main',$data);
        }
    }  

    /*
     * Editing a dosificacion
     */
    function edit($dosificacion_id)
    {   
        // check if the dosificacion exists before trying to edit it
        $data['dosificacion'] = $this->Dosificacion_model->get_dosificacion($dosificacion_id);
        
        if(isset($data['dosificacion']['dosificacion_id']))
        {
            if(isset($_POST) && count($_POST) > 0)     
            {   
                $params = array(
					'estado_id' => $this->input->post('estado_id'),
					'empresa_id' => $this->input->post('empresa_id'),
					'dosificacion_fechahora' => $this->input->post('dosificacion_fechahora'),
					'dosificacion_nitemisor' => $this->input->post('dosificacion_nitemisor'),
					'dosificacion_autorizacion' => $this->input->post('dosificacion_autorizacion'),
					'dosificacion_llave' => $this->input->post('dosificacion_llave'),
					'dosificacion_numfact' => $this->input->post('dosificacion_numfact'),
					'dosificacion_leyenda1' => $this->input->post('dosificacion_leyenda1'),
					'dosificacion_leyenda2' => $this->input->post('dosificacion_leyenda2'),
					'dosificacion_sucursal' => $this->input->post('dosificacion_sucursal'),
					'dosificacion_sfc' => $this->input->post('dosificacion_sfc'),
					'dosificacion_actividad' => $this->input->post('dosificacion_actividad'),
                );

                $this->Dosificacion_model->update_dosificacion($dosificacion_id,$params);            
                redirect('dosificacion/index');
            }
            else
            {
				$this->load->model('Estado_model');
				$data['all_estado'] = $this->Estado_model->get_all_estado();

				$this->load->model('Empresa_model');
				$data['all_empresa'] = $this->Empresa_model->get_all_empresa();

                $data['_view'] = 'dosificacion/edit';
                $this->load->view('layouts/main',$data);
            }
        }
        else
            show_error('The dosificacion you are trying to edit does not exist.');
    } 

    /*
     * Deleting dosificacion
     */
    function remove($dosificacion_id)
    {
        $dosificacion = $this->Dosificacion_model->get_dosificacion($dosificacion_id);

        // check if the dosificacion exists before trying to delete it
        if(isset($dosificacion['dosificacion_id']))
        {
            $this->Dosificacion_model->delete_dosificacion($dosificacion_id);
            redirect('dosificacion/index');
        }
        else
            show_error('The dosificacion you are trying to delete does not exist.');
    }
    
}
