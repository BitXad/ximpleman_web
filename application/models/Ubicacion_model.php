<?php
/* 
 * Generated by CRUDigniter v3.2 
 * www.crudigniter.com
 */
 
class Ubicacion_model extends CI_Model
{
    function __construct()
    {
        parent::__construct();
    }
    
    // /*
    //  * Get unidad by unidad_id
    //  */
    function get_ubicacion($ubicacion_id)
    {
        return $this->db->get_where('ubicacion',array('ubicacion_id'=>$ubicacion_id))->row_array();
    }
        
    /*
     * Get all unidad
     */
    function get_all_ubicacion(){
        $ubicacion = $this->db->query(
            "SELECT
                u.*, e.estado_descripcion
            FROM
                ubicacion as u,
                estado as e
            WHERE
                u.estado_id = e.estado_id
                ORDER BY ubicacion_id ASC
        ")->result_array();

        return $ubicacion;
    }

    /*
     * function to add new unidad
     */
    function add_ubicacion($params)
    {
        $this->db->insert('ubicacion',$params);
        return $this->db->insert_id();
    }
    
    /*
     * function to update ubicacion
     */
    function update_ubicacion($ubicacion_id,$params)
    {
        $this->db->where('ubicacion_id',$ubicacion_id);
        return $this->db->update('ubicacion',$params);
    }
    /**
     * get ubicaiones disponibles
     */
    function get_disponibles($controli_id){
        return $this->db->query(
            "SELECT u.*
            from ubicacion u 
            left join (select cu.*
                        from control_ubicacion cu
                        where cu.controli_id = $controli_id) as cu2 on u.ubicacion_id = cu2.ubicacion_id
            where cu2.controlu_id is null"
        )->result_array();
    }
}
